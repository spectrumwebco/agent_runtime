# Netlify configuration for {{project_name}}
# Generated by Rumble

[build]
  # Directory to change to before starting a build
  base = "{{#base_dir}}{{.}}{{/base_dir}}{{^base_dir}}.{{/base_dir}}"
  
  # Directory that contains the deploy-ready HTML files and assets
  publish = "{{#publish_dir}}{{.}}{{/publish_dir}}{{^publish_dir}}dist{{/publish_dir}}"
  
  # Default build command
  command = "{{#build_command}}{{.}}{{/build_command}}{{^build_command}}npm run build{{/build_command}}"

  # Environment variables
  {{#build_env}}
  [build.environment]
    {{#env_vars}}
    {{key}} = "{{value}}"
    {{/env_vars}}
  {{/build_env}}

{{#functions}}
# Serverless functions configuration
[functions]
  # Directory with serverless functions, including package.json
  directory = "{{#functions_dir}}{{.}}{{/functions_dir}}{{^functions_dir}}functions{{/functions_dir}}"
  
  # Include files as part of functions
  {{#included_files}}
  included_files = [{{#files}}"{{.}}", {{/files}}]
  {{/included_files}}
  
  # External node_modules to include
  {{#external_node_modules}}
  external_node_modules = [{{#modules}}"{{.}}", {{/modules}}]
  {{/external_node_modules}}
{{/functions}}

{{#redirects}}
# Redirect rules
[[redirects]]
  from = "{{from}}"
  to = "{{to}}"
  status = {{#status}}{{.}}{{/status}}{{^status}}301{{/status}}
  force = {{#force}}{{.}}{{/force}}{{^force}}false{{/force}}
  {{#query}}
  query = {{{.}}}
  {{/query}}
  {{#conditions}}
  conditions = {{{.}}}
  {{/conditions}}
  {{#signed}}
  signed = "{{.}}"
  {{/signed}}
{{/redirects}}

{{#spa}}
# SPA redirect rule
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
{{/spa}}

{{#headers}}
# Custom headers
[[headers]]
  for = "{{path}}"
  {{#values}}
  [headers.values]
    {{#header_pairs}}
    {{key}} = "{{value}}"
    {{/header_pairs}}
  {{/values}}
{{/headers}}

{{#plugins}}
# Netlify plugins
[[plugins]]
  package = "{{package}}"
  {{#inputs}}
  [plugins.inputs]
    {{#input_pairs}}
    {{key}} = "{{value}}"
    {{/input_pairs}}
  {{/inputs}}
{{/plugins}}

{{#edge_functions}}
# Edge functions
[[edge_functions]]
  path = "{{path}}"
  function = "{{function}}"
{{/edge_functions}}

{{#dev}}
# Development server settings
[dev]
  command = "{{#dev_command}}{{.}}{{/dev_command}}{{^dev_command}}npm run dev{{/dev_command}}"
  port = {{#dev_port}}{{.}}{{/dev_port}}{{^dev_port}}8888{{/dev_port}}
  targetPort = {{#target_port}}{{.}}{{/target_port}}{{^target_port}}3000{{/target_port}}
  framework = "{{#framework}}{{.}}{{/framework}}{{^framework}}#custom{{/framework}}"
  autoLaunch = {{#auto_launch}}{{.}}{{/auto_launch}}{{^auto_launch}}true{{/auto_launch}}
{{/dev}}

{{#build_processing}}
# Build processing
[build.processing]
  skip_processing = {{#skip_processing}}{{.}}{{/skip_processing}}{{^skip_processing}}false{{/skip_processing}}
  
  {{#css}}
  [build.processing.css]
    bundle = {{#bundle}}{{.}}{{/bundle}}{{^bundle}}true{{/bundle}}
    minify = {{#minify}}{{.}}{{/minify}}{{^minify}}true{{/minify}}
  {{/css}}
  
  {{#js}}
  [build.processing.js]
    bundle = {{#bundle}}{{.}}{{/bundle}}{{^bundle}}true{{/bundle}}
    minify = {{#minify}}{{.}}{{/minify}}{{^minify}}true{{/minify}}
  {{/js}}
  
  {{#html}}
  [build.processing.html]
    pretty_urls = {{#pretty_urls}}{{.}}{{/pretty_urls}}{{^pretty_urls}}true{{/pretty_urls}}
  {{/html}}
  
  {{#images}}
  [build.processing.images]
    compress = {{#compress}}{{.}}{{/compress}}{{^compress}}true{{/compress}}
  {{/images}}
{{/build_processing}}

{{#context}}
# Context-specific configuration
[context.production]
  command = "{{#command}}{{.}}{{/command}}{{^command}}npm run build{{/command}}"
  {{#environment}}
  [context.production.environment]
    {{#env_vars}}
    {{key}} = "{{value}}"
    {{/env_vars}}
  {{/environment}}

[context.deploy-preview]
  command = "{{#preview_command}}{{.}}{{/preview_command}}{{^preview_command}}npm run build{{/preview_command}}"
  {{#preview_environment}}
  [context.deploy-preview.environment]
    {{#env_vars}}
    {{key}} = "{{value}}"
    {{/env_vars}}
  {{/preview_environment}}

[context.branch-deploy]
  command = "{{#branch_command}}{{.}}{{/branch_command}}{{^branch_command}}npm run build:branch{{/branch_command}}"
  {{#branch_environment}}
  [context.branch-deploy.environment]
    {{#env_vars}}
    {{key}} = "{{value}}"
    {{/env_vars}}
  {{/branch_environment}}
{{/context}}

{{#custom_sections}}
# Custom section: {{name}}
[{{name}}]
  {{#properties}}
  {{key}} = {{value}}
  {{/properties}}
{{/custom_sections}}
